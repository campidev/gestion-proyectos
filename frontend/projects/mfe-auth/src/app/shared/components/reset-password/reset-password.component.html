<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-6">
      <mat-card class="p-4 shadow-lg rounded">
        <h2 class="text-center mb-4">Cambiar Contraseña</h2>

        <form [formGroup]="passwordForm">
          <!-- Contraseña -->
          <!-- Contraseña -->
<mat-form-field appearance="outline" class="w-100 mb-3">
  <mat-label>Contraseña</mat-label>
  <input
    matInput
    [type]="showPassword ? 'text' : 'password'"
    formControlName="password"
    placeholder="Ingrese su contraseña"
  />
  <button
    mat-icon-button
    matSuffix
    type="button"
    (click)="togglePasswordVisibility('password')"
  >
    <mat-icon>{{ showPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
  </button>
  <mat-error
    *ngIf="passwordForm.get('password')?.invalid && passwordForm.get('password')?.touched"
  >
    La contraseña es obligatoria y debe tener mínimo 8 caracteres.
  </mat-error>
</mat-form-field>

<!-- Confirmar contraseña -->
<mat-form-field appearance="outline" class="w-100 mb-3">
  <mat-label>Confirmar contraseña</mat-label>
  <input
    matInput
    [type]="showConfirmPassword ? 'text' : 'password'"
    formControlName="confirmPassword"
    placeholder="Confirme su contraseña"
  />
  <button
    mat-icon-button
    matSuffix
    type="button"
    (click)="togglePasswordVisibility('confirm')"
  >
    <mat-icon>{{ showConfirmPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
  </button>
  <mat-error *ngIf="passwordForm.hasError('passwordMismatch')">
    Las contraseñas no coinciden.
  </mat-error>
</mat-form-field>

          <!-- Lista de requisitos -->
          <div class="mb-3">
            <p><strong>La contraseña debe contener:</strong></p>
            <ul class="requirements">
              <li>
                <mat-icon [color]="hasMinLength ? 'primary' : null">
                  {{ hasMinLength ? "check_circle" : "radio_button_unchecked" }}
                </mat-icon>
                Mínimo 8 caracteres
              </li>
              <li>
                <mat-icon [color]="hasUpper ? 'primary' : null">
                  {{ hasUpper ? "check_circle" : "radio_button_unchecked" }}
                </mat-icon>
                Al menos una mayúscula
              </li>
              <li>
                <mat-icon [color]="hasLower ? 'primary' : null">
                  {{ hasLower ? "check_circle" : "radio_button_unchecked" }}
                </mat-icon>
                Al menos una minúscula
              </li>
              <li>
                <mat-icon [color]="hasSpecial ? 'primary' : null">
                  {{ hasSpecial ? "check_circle" : "radio_button_unchecked" }}
                </mat-icon>
                Al menos un carácter especial
              </li>
              <li>
                <mat-icon [color]="passwordsMatch ? 'primary' : null">
                  {{ passwordsMatch ? "check_circle" : "radio_button_unchecked" }}
                </mat-icon>
                Las contraseñas coinciden
              </li>
            </ul>
          </div>
        </form>

        <div class="d-flex justify-content-end mt-3">
          <button mat-stroked-button color="warn" (click)="goToLogin()">
            Cancelar
          </button>
          <button
            mat-raised-button
            color="primary"
            class="ms-2"
            (click)="onSave()"
            [disabled]="!passwordForm.valid || loading"
          >
            {{ loading ? "Guardando..." : "Guardar" }}
          </button>
        </div>
      </mat-card>
    </div>
  </div>
</div>
